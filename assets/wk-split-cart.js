var callback=()=>{if(749>window.innerWidth)for(var a=document.getElementsByClassName("wk-split__cart__table"),b=0;b<a.length;b++)for(var c=a[b].getElementsByTagName("tbody"),d=c[0].getElementsByTagName("tr"),e=0;e<d.length;e++){var f=d[e].getElementsByTagName("td"),g=f[4].cloneNode(!0);g.setAttribute("colspan","1"),d[e].after(g);var h=f[3].cloneNode(!0);h.setAttribute("colspan","2"),d[e].after(h),f[3].remove()}var l=document.getElementsByClassName("wk-buy"),m=jQuery.ajax({url:"/cart.js",dataType:"json",cache:!1,success:()=>{wkCartItems=m.responseJSON,"undefined"==typeof wkCartItems&&(wkCartItems=m.responseText,wkCartItems=JSON.parse(wkCartItems)),items=wkCartItems.items;for(var a=0;a<l.length;a++)l[a].onclick=function(a){a.preventDefault();var b=sessionStorage.getItem("WK_SHOPIFY_SPLIT_CART");if(""!==b&&null!==b){var c=this.getAttribute("data-params"),d=this.getAttribute("data-vendor"),e=d.split(" "),f=0,g=0;if(e=e.join("_"),$("*[id='route_insurance_"+e+"']").length){var h=$("*[id='route_insurance_"+e+"']").attr("data-insurance_checked");("true"==h||!0==h)&&(g=$("*[id='insurance_price_"+e+"']").attr("data-price"),f=1,draft_order_enabled=1)}if($(".wk_po_count").length&&(draft_order_enabled=1),1===draft_order_enabled||1==draft_order_enabled){var i={status:pickup_by_cart_enabled};if(1==pickup_by_cart_enabled){var j=d+"attributes-store_pickup",k=$("input[name='"+j+"']:checked");if("undefined"==typeof k)return!1;var l=$("input[name='"+j+"']:checked").val();if(i.is_pickup=l,"YES"==l){var m=$("*[id='cart_pickup_"+e+"']");if("undefined"!=typeof m&&0<m.val().length){m=m.val(),m=m.split("//"),i.loc=m[1],i.locId=m[0],"undefined"!=typeof m[2]&&(i.locName=m[2]);var n=[];items.forEach(async function(a){if(a.vendor==d){var b={};b[a.variant_id]=a.quantity,n.push(b)}}),jQuery.ajax({url:server_name+"index.php?p=get_pickup_by_cart",dataType:"jsonp",type:"GET",contentType:"application/json",jsonpCallback:"validateCartLocations",data:{shop_name:Shopify.shop,varient_ids:n,cart_loc:m[0]},success:function(a){if("true"!==$.trim(a)){var b="<div class='cart-pickup-error'>   <strong>"+a+"</strong> "+pickup_by_cart_error_message+"</div>";return document.getElementById("wkCartLocError_"+e).innerHTML=b,$("wkCartLoc_"+vendor).css("background-color","#ecb9b9"),$("button.wk-buy[data-vendor="+d+"]").hide(),!1}draftOrder(items,d,i,{order_insurance_enabled:f,order_insurance_price:g})}})}}else draftOrder(items,d,i,{order_insurance_enabled:f,order_insurance_price:g})}else draftOrder(items,d,i,{order_insurance_enabled:f,order_insurance_price:g})}else if("undefined"!=document.getElementsByClassName("wk_pay_what_you_want_count_split_cart")&&0<document.getElementsByClassName("wk_pay_what_you_want_count_split_cart").length)draftOrder(items,d,{status:0},{order_insurance_enabled:f,order_insurance_price:g});else{var o=$(this).parent().parent().parent().parent().children(".wk-order-note");if("undefined"!=typeof o.children("textarea")&&0<o.children("textarea").length){var p=o.children("textarea")[0].value;"undefined"!=typeof p&&""!=p&&(c+="?note="+encodeURIComponent(p))}var q=!1;items.forEach(async function(a){if(a.vendor==d&&null!=a.properties&&0<a.properties.length){if("YES"==a.properties.store_pickup);q=!0}});var r=sessionStorage.getItem("WK_SHOPIFY_SPLIT_CART");if(null!==r){r=r.split("&*#*&");var s=r.indexOf(d);-1<s&&r.splice(s,1)}q?draftOrder(items,d,{status:0},{order_insurance_enabled:f,order_insurance_price:g}):(sessionStorage.removeItem(d),sessionStorage.setItem("WK_SHOPIFY_SPLIT_CART",r),window.location.href+="/"+c)}}}}})};function wkRemoveItem(a){var b={},c=sessionStorage.getItem("WK_SHOPIFY_SPLIT_CART"),d=sessionStorage.getItem("order_note");if(null!==d&&""!==d&&sessionStorage.removeItem("order_note"),""!==c&&null!==c){c=c.split(",");for(var e,f=0;f<c.length;f++)e=document.getElementById("cartSpecialInstructions_"+c[f]),b[c[f]]="undefined"!=typeof e&&null!=e?e.value:"";var g=JSON.stringify(b);sessionStorage.setItem("order_note",g)}sessionStorage.removeItem(a);var h=sessionStorage.getItem("WK_SHOPIFY_SPLIT_CART");if(null!==h){h=h.split(",");var j=h.indexOf(a);-1<j&&h.splice(j,1),sessionStorage.setItem("WK_SHOPIFY_SPLIT_CART",h)}}function draftOrder(a,b,c,d){let e=$(".wk_po_count").length,f=meta.page.customerId;if(e){let a=document.location.href;if("undefined"==typeof f)return window.open("/account/login?checkout_url="+a+"#wkpreorder","_top"),!1}var g="",h=document.getElementById("cartSpecialInstructions_"+b);if("undefined"!=typeof h&&null!=h&&0<h.value.length&&(g=h.value),1==c.status){var j={},k=[];j["store_pickup_by_cart"]=c.is_pickup,j["wk_loc_id"]=c.locId,k.push(j)}else var k=!1;cart_arr=[];var l=0;a.forEach(async function(a){if(a.vendor==b){var d={title:a.variant_title,quantity:a.quantity,product_id:a.product_id,variant_id:a.variant_id,price:a.price,handle:a.handle,product_title:a.product_title,unit_discount:a.total_discount};if(1==c.status)if(null!==a.properties)"YES"==c.is_pickup?(a.properties.store_pickup="YES",a.properties.store_pickup_address=c.loc,"undefined"!=typeof c.locName&&(a.properties.store_pickup_location_name=c.locName)):a.properties.store_pickup="NO";else{var e={};"YES"==c.is_pickup?(e.store_pickup="YES",e.store_pickup_address=c.loc,"undefined"!=typeof c.locName&&(e.store_pickup_location_name=c.locName)):e.store_pickup="NO",a.properties=e}d.properties=a.properties,d.note=g,d.requires_shipping=a.requires_shipping,cart_arr[l]=d,l++}}),jQuery.ajax({type:"POST",url:server_name+"index.php?p=ajax_product_properties",cache:!1,data:{callback:"getProductProperties",code:"new",shop_name:Shopify.shop,cart_details:cart_arr,cart_token:wkCartItems.token,note_attribute:k,wk_insurance_selected:d.order_insurance_enabled,wk_routes_insurance_price:d.order_insurance_price,wk_preorder_count:e,customer_id:meta.page.customerId,vendor:b},success:function(a){if(console.log(a),"req_qty_not_found"==a){console.log("preorder error!!!");var c=$("*[data-vendor='"+b+"']");c.hide();let a=SPL.$("<div class='wk_po_msg__div'><p style='color:red; word-wrap:break-word;' >"+wk_preorder_qty_error_label+"</p></div>");c.after(a)}else"denied"!=a&&(sessionStorage.setItem("WK_DRAFT_VENDOR",b),window.location.href=a.invoice_url)},dataType:"json"})}if("undefined"==typeof jQuery){var script;script=document.createElement("script"),script.type="text/javascript",script.src="//ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js",document.getElementsByTagName("head")[0].appendChild(script),"complete"!==document.readyState&&("loading"===document.readyState||document.documentElement.doScroll)?window.addEventListener("load",callback):callback()}else callback();